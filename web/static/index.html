<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AppImage Re-Signer - Web Interface</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16px.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32px.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/static/favicon-48px.png">
    
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <!-- Logo Header - Outside Container, Above Container -->
    <div style="max-width: 800px; width: 100%; margin: 0 auto 20px auto; padding: 0 20px;">
        <img src="/static/logo_ionos.png" alt="IONOS Logo" style="max-width: 150px; height: auto;">
    </div>

    <div class="container">
        <!-- Dark Mode Toggle -->
        <button class="theme-toggle" id="theme-toggle" title="Dark/Light Mode wechseln">
            <span id="theme-icon">ğŸŒ™</span>
        </button>

        <header>
            <h1>ğŸ” AppImage Re-Signer</h1>
            <p class="subtitle">Signieren Sie Ihre AppImages einfach Ã¼ber das Web</p>
        </header>

        <main>
            <!-- Step 1: Upload AppImage -->
            <section class="card" id="step1">
                <div class="step-header">
                    <span class="step-number">1</span>
                    <h2>AppImage hochladen</h2>
                </div>
                
                <div class="upload-area" id="appimage-drop-zone">
                    <div class="upload-icon">ğŸ“¦</div>
                    <p>AppImage hier ablegen oder klicken zum AuswÃ¤hlen</p>
                    <input type="file" id="appimage-input" accept=".AppImage" hidden>
                    <div class="file-info" id="appimage-info" style="display: none;">
                        <span class="filename"></span>
                        <span class="filesize"></span>
                    </div>
                </div>

                <!-- Original Signature Info -->
                <div class="signature-info" id="original-signature" style="display: none;">
                    <h4>ğŸ“œ Signatur gefunden:</h4>
                    <div id="original-signature-content"></div>
                    <button class="btn-secondary" id="verify-signature-button" style="margin-top: 15px; display: none;">
                        <span class="btn-icon">ğŸ”</span>
                        Signatur verifizieren
                    </button>
                </div>

                <!-- Optional: Upload .asc signature file -->
                <div class="upload-hint" style="margin-top: 1rem; display: none;" id="signature-upload-hint">
                    <small>Optional: <a href="#" id="upload-signature-link">Signatur-Datei (.asc) hochladen</a> um die aktuelle Signatur zu prÃ¼fen</small>
                    <input type="file" id="signature-input" accept=".asc" hidden>
                </div>
            </section>

            <!-- Step 2: Upload Key or Enter Key ID -->
            <section class="card" id="step2" style="opacity: 0.5; pointer-events: none;">
                <div class="step-header">
                    <span class="step-number">2</span>
                    <h2>GPG Key bereitstellen</h2>
                </div>
                
                <div class="key-options">
                    <div class="option-tabs">
                        <button class="tab-button active" data-tab="upload">Key hochladen</button>
                        <button class="tab-button" data-tab="keyid">Key ID eingeben</button>
                    </div>

                    <div class="tab-content active" id="upload-tab">
                        <div class="upload-area" id="key-drop-zone">
                            <div class="upload-icon">ğŸ”‘</div>
                            <p>GPG Private Key hier ablegen oder klicken</p>
                            <input type="file" id="key-input" accept=".key,.gpg,.asc" hidden>
                            <div class="file-info" id="key-info" style="display: none;">
                                <span class="filename"></span>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="keyid-tab">
                        <div class="form-group">
                            <label for="key-id-input">Key ID:</label>
                            <input type="text" id="key-id-input" placeholder="z.B. C407155E5D49FE6B">
                            <small>Key muss bereits im System GPG Keyring vorhanden sein</small>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="passphrase-input">Passphrase (optional):</label>
                    <input type="password" id="passphrase-input" placeholder="Key-Passphrase falls vorhanden">
                </div>

                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="embed-signature" style="width: auto; margin: 0;">
                        <span>Signatur in AppImage einbetten</span>
                    </label>
                    <small>Erstellt sowohl eine .asc Datei als auch eine eingebettete Signatur</small>
                </div>
            </section>

            <!-- Step 3: Sign -->
            <section class="card" id="step3" style="opacity: 0.5; pointer-events: none;">
                <div class="step-header">
                    <span class="step-number">3</span>
                    <h2>Signieren</h2>
                </div>
                
                <button class="btn-primary" id="sign-button">
                    <span class="btn-icon">âœï¸</span>
                    AppImage signieren
                </button>

                <div class="progress" id="progress" style="display: none;">
                    <div class="progress-bar"></div>
                    <p class="progress-text">Signierung lÃ¤uft...</p>
                </div>
            </section>

            <!-- Step 4: Results -->
            <section class="card" id="step4" style="display: none;">
                <div class="step-header">
                    <span class="step-number">âœ“</span>
                    <h2>Ergebnis</h2>
                </div>

                <div class="result-success" id="result-success">
                    <div class="success-icon">âœ…</div>
                    <h3>Signierung erfolgreich!</h3>
                    
                    <div class="verification-details" id="verification-details">
                        <!-- Will be filled by JavaScript -->
                    </div>

                    <div class="download-buttons">
                        <a href="#" class="btn-download" id="download-appimage">
                            <span>ğŸ“¦</span>
                            Signierte AppImage herunterladen
                        </a>
                        <a href="#" class="btn-download" id="download-signature">
                            <span>ğŸ”</span>
                            Signatur (.asc) herunterladen
                        </a>
                    </div>
                </div>

                <div class="result-error" id="result-error" style="display: none;">
                    <div class="error-icon">âŒ</div>
                    <h3>Signierung fehlgeschlagen</h3>
                    <p class="error-message" id="error-message"></p>
                </div>

                <button class="btn-secondary" id="reset-button">
                    <span class="btn-icon">ğŸ”„</span>
                    Neue Signierung starten
                </button>
            </section>
        </main>

        <footer>
            <p>
                <strong>AppImage Re-Signer</strong> <span id="app-version" class="version-badge">v2.0.0</span>
                <br>
                <a href="https://github.com/xXRoxXeRXx/appimage-resigner" target="_blank">
                    ğŸ“¦ GitHub Repository
                </a>
                |
                <a href="/health" target="_blank" title="System Health Check">
                    â¤ï¸ Health Status
                </a>
                <br>
                <span style="opacity: 0.7;">Made with â¤ï¸ and AI in Berlin ğŸš€</span>
            </p>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
